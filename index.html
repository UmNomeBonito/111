<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reconhecimento de Gestos com as M√£os</title>

    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

    <!-- CSS Personalizado -->
    <link rel="stylesheet" href="style.css">

    <!-- Webcam.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/webcamjs/1.0.25/webcam.min.js"></script>

    <!-- ml5.js -->
    <script src="https://unpkg.com/ml5@0.4.3/dist/ml5.min.js"></script>
</head>
<body>
    <!-- Cabe√ßalho -->
    <header class="bg-primary text-white text-center py-3">
        <h1>Aplicativo de Reconhecimento de Gestos com as M√£os üëã</h1>
    </header>

    <div class="container mt-4">
        <!-- Lista de √çcones de Gestos -->
        <div class="mb-4 text-center">
            <h5>Gestos de M√£o Suportados</h5>
            <p>üëç (U+1F44D), ‚úåÔ∏è (U+270C), ü§ô (U+1F919)</p>
        </div>

        <!-- Visualiza√ß√£o da Webcam -->
        <div id="webcam" class="d-flex justify-content-center mb-4">
            <!-- O feed da webcam ser√° exibido aqui -->
        </div>

        <!-- Bot√£o para Capturar Imagem -->
        <div class="text-center mb-4">
            <button class="btn btn-success" onclick="captureImage()">Capturar Imagem</button>
        </div>

        <!-- Exibi√ß√£o do Nome do Gesto -->
        <div class="text-center mb-4">
            <span id="gesture-name" class="h4">Nome do Gesto</span>
        </div>

        <!-- Exibi√ß√£o do √çcone do Gesto -->
        <div class="text-center mb-4">
            <span id="gesture-icon" class="h4">ü§î</span> <!-- √çcone padr√£o -->
        </div>

        <!-- Exibi√ß√£o da Imagem Capturada -->
        <div id="captured-image" class="d-flex justify-content-center mb-4">
            <!-- A imagem capturada ser√° exibida aqui -->
        </div>

        <!-- Bot√£o para Identificar o Gesto -->
        <div class="text-center">
            <button class="btn btn-primary" onclick="identifyGesture()">Identificar Gesto</button>
        </div>
    </div>


    <script>
        // Configurar webcam
        Webcam.set({
            width: 320,
            height: 240,
            image_format: 'jpeg',
            jpeg_quality: 90
        });
        Webcam.attach('#webcam');

        // Fun√ß√£o para capturar a imagem
        function captureImage() {
            Webcam.snap(function(data_uri) {
                document.getElementById('captured-image').innerHTML = 
                    '<img src="'+data_uri+'" class="img-fluid"/>';
            });
        }

        // Carregar modelo ml5
        const modelUrl = 'https://teachablemachine.withgoogle.com/models/KqnJfCFNW/model.json';
        let classifier;

        ml5.imageClassifier(modelUrl)
            .then(model => {
                classifier = model;
                console.log('Modelo carregado:', classifier);
            })
            .catch(error => console.error('Erro ao carregar o modelo:', error));

        // Fun√ß√£o para identificar o gesto
        function identifyGesture() {
            const imgElement = document.querySelector('#captured-image img');
            if (imgElement && classifier) {
                classifier.classify(imgElement)
                    .then(results => {
                        const gestureName = results[0].label;
                        const gestureIcon = getGestureIcon(gestureName);

                        document.getElementById('gesture-name').innerText = gestureName;
                        document.getElementById('gesture-icon').innerText = gestureIcon;
                    })
                    .catch(error => console.error('Erro ao identificar o gesto:', error));
            }
        }

        // Fun√ß√£o para obter o √≠cone do gesto baseado no nome
        function getGestureIcon(gestureName) {
            const icons = {
                'Afirmativo': 'üëç',
                'Paz': '‚úåÔ∏è',
                'Hang Loose': 'ü§ô'
            };
            return icons[gestureName] || 'ü§î';
        }
        
        // Console a vers√£o ml5.js
        console.log('Vers√£o ml5.js:', ml5.version);
    </script>
</body>
</html>
